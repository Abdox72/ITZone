<div class="jitsi-meeting-container">
  <div class="header">
    <h2><i class="fas fa-video"></i> إنشاء ميتنج Jitsi</h2>
    <p>قم بإنشاء ميتنج جديد مع إمكانية التسجيل والتحليل التلقائي</p>
  </div>

  <div class="meeting-form" *ngIf="!currentMeeting">
    <form (ngSubmit)="createMeeting()" #meetingForm="ngForm">
      <div class="form-group">
        <label for="roomName">اسم الغرفة:</label>
        <input 
          type="text" 
          id="roomName" 
          name="roomName"
          [(ngModel)]="meetingData.roomName"
          placeholder="أدخل اسم الغرفة (اختياري)"
          class="form-control">
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="startTime">وقت البداية:</label>
          <input 
            type="datetime-local" 
            id="startTime" 
            name="startTime"
            [(ngModel)]="meetingData.startTime"
            required
            class="form-control">
        </div>

        <div class="form-group">
          <label for="endTime">وقت النهاية:</label>
          <input 
            type="datetime-local" 
            id="endTime" 
            name="endTime"
            [(ngModel)]="meetingData.endTime"
            required
            class="form-control">
        </div>
      </div>

      <div class="form-group">
        <label for="participants">المشاركون (البريد الإلكتروني):</label>
        <textarea 
          id="participants" 
          name="participants"
          [(ngModel)]="participantsText"
          placeholder="أدخل عناوين البريد الإلكتروني مفصولة بفواصل"
          class="form-control"
          rows="3"></textarea>
      </div>

      <div class="form-group">
        <label class="checkbox-label">
          <input 
            type="checkbox" 
            name="enableRecording"
            [(ngModel)]="meetingData.enableRecording">
          <span class="checkmark"></span>
          تفعيل التسجيل التلقائي
        </label>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="isLoading">
          <i class="fas fa-plus"></i>
          {{ isLoading ? 'جاري الإنشاء...' : 'إنشاء الميتنج' }}
        </button>
      </div>
    </form>
  </div>

  <div class="meeting-details" *ngIf="currentMeeting">
    <div class="meeting-info">
      <h3><i class="fas fa-video"></i> {{ currentMeeting.roomName || 'ميتنج Jitsi' }}</h3>
      <div class="meeting-stats">
        <div class="stat">
          <i class="fas fa-clock"></i>
          <span>وقت البداية: {{ currentMeeting.startTime | date:'short' }}</span>
        </div>
        <div class="stat">
          <i class="fas fa-stop-circle"></i>
          <span>وقت النهاية: {{ currentMeeting.endTime | date:'short' }}</span>
        </div>
        <div class="stat">
          <i class="fas fa-users"></i>
          <span>عدد المشاركين: {{ (currentMeeting.participantEmails.length) || 0 }}</span>
        </div>
        <div class="stat">
          <i class="fas fa-record-vinyl" [class.recording]="currentMeeting.isRecording"></i>
          <span>{{ currentMeeting.isRecording ? 'جاري التسجيل' : 'غير مسجل' }}</span>
        </div>
      </div>
    </div>

    <div class="meeting-actions">
      <a [href]="currentMeeting.jitsiUrl" target="_blank" class="btn btn-success">
        <i class="fas fa-external-link-alt"></i>
        انضم للميتنج
      </a>

      <button 
        (click)="startRecording()" 
        class="btn btn-warning"
        [disabled]="currentMeeting.isRecording || isRecordingLoading">
        <i class="fas fa-record-vinyl"></i>
        {{ isRecordingLoading ? 'جاري البدء...' : 'بدء التسجيل' }}
      </button>

      <button 
        (click)="stopRecording()" 
        class="btn btn-danger"
        [disabled]="!currentMeeting.isRecording || isRecordingLoading">
        <i class="fas fa-stop"></i>
        {{ isRecordingLoading ? 'جاري الإيقاف...' : 'إيقاف التسجيل' }}
      </button>

      <button (click)="resetMeeting()" class="btn btn-secondary">
        <i class="fas fa-plus"></i>
        ميتنج جديد
      </button>
    </div>

    <div class="recording-info" *ngIf="currentMeeting.recordingUrl">
      <h4><i class="fas fa-file-audio"></i> معلومات التسجيل</h4>
      <div class="recording-url">
        <strong>رابط التسجيل:</strong>
        <a [href]="currentMeeting.recordingUrl" target="_blank" class="recording-link">
          {{ currentMeeting.recordingUrl }}
        </a>
      </div>
      <div class="recording-actions">
        <button (click)="uploadRecording()" class="btn btn-info">
          <i class="fas fa-upload"></i>
          رفع التسجيل للتحليل
        </button>
        
      </div>
    </div>
  </div>

  <div class="error-message" *ngIf="errorMessage">
    <i class="fas fa-exclamation-triangle"></i>
    {{ errorMessage }}
  </div>

  <div class="success-message" *ngIf="successMessage">
    <i class="fas fa-check-circle"></i>
    {{ successMessage }}
  </div>
</div> 